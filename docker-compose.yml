version: '3.8'

services:
  # Euclid Transpiler Service
  transpiler:
    build: .
    image: euclid:latest
    container_name: euclid-transpiler
    volumes:
      - ./:/workspace
    working_dir: /workspace
    command: ["java", "-jar", "/app/euclid-transpiler.jar", "--help"]

  # Euclid REPL Service (Interactive)
  repl:
    build: .
    image: euclid:latest
    container_name: euclid-repl
    stdin_open: true
    tty: true
    command: ["java", "-jar", "/app/euclid-repl.jar"]

# Usage:
# Build: docker-compose build
# Run transpiler: docker-compose run --rm transpiler java -jar /app/euclid-transpiler.jar input.ed output.md
# Run REPL: docker-compose run --rm repl
# Run with verbose mode: docker-compose run --rm transpiler java -jar /app/euclid-transpiler.jar --verbose input.ed
